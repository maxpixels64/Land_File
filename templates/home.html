<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Home</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css')}}"
    />
  </head>
  <body>
    <h2>Hello, {{ current_user.username }}</h2>
    <p>
      <a href="{{ url_for('logout') }}">Logout</a>
    </p>
    <p>
      <a href="{{ url_for('public_files') }}">View Public Files</a>
    </p>
    <hr />

    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %}
    <div class="flashes">
      {% for category, message in messages %}
      <div class="alert alert-{{ category }}">{{ message }}</div>
      {% endfor %}
    </div>
    {% endif %} {% endwith %}

    <h2>Create a Folder</h2>
    <form action="{{ url_for('create_folder') }}" method="POST">
      <input
        type="text"
        name="folder_name"
        placeholder="New folder name"
        required
      />
      <button type="submit">Create Folder</button>
    </form>

    <h2>Your Folders</h2>
    <ul>
      {% for foldername in folders %}
      <li>
        <a href="{{ url_for('view_folder', foldername=foldername) }}">
          {{ foldername }}
        </a>
      </li>
      {% else %}
      <li>No folders found.</li>
      {% endfor %}
    </ul>

    <h2>Recent Files</h2>
    <table border="1" cellpadding="5">
      <thead>
        <tr>
          <th>Owner ID</th>
          <th>File Name</th>
          <th>Size</th>
          <th>Time Uploaded</th>
          <th>Download</th>
        </tr>
      </thead>
      <tbody>
        {% if files %} {% for f in files %}
        <tr>
          <td>{{ f.owner }}</td>
          <td>{{ f.filename }}</td>
          <td>{{ f.size }} bytes</td>
          <td>{{ f.time_uploaded.strftime('%Y-%m-%d %H:%M') }}</td>
          <td>
            {% if not f.is_encrypted %}
            <a href="{{ url_for('download', file_id=f.id) }}">â¬‡ Download</a>
            {% else %}
            <span style="color: red">Encrypted</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %} {% else %}
        <tr>
          <td colspan="6" style="text-align: center">
            No files found in this folder.
          </td>
        </tr>
        {% endif %}
      </tbody>
    </table>
  </body>
</html>
